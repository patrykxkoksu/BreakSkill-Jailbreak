local exploit_type

if syn then
	exploit_type = "Synapse X"
elseif getexecutorname then
	exploit_type = "Script-Ware"
else
	game:GetService("Players").LocalPlayer:Kick("BreakSkill Hub | Your executor is not supported!")
end

local library = {
	Toggle = true,
	FirstTab = nil,
	TabCount = 0,
	ColorTable = {}
}

local RS = game:GetService("RunService")
local HS = game:GetService("HttpService")
local TS = game:GetService("TweenService")
local UIS = game:GetService("UserInputService")

local function MakeDraggable(topbarobject, object)
	local Dragging = nil
	local DragInput = nil
	local DragStart = nil
	local StartPosition = nil
	
	topbarobject.InputBegan:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
			Dragging = true
			DragStart = input.Position
			StartPosition = object.Position
			
			input.Changed:Connect(function()
				if input.UserInputState == Enum.UserInputState.End then
					Dragging = false
				end
			end)
		end
	end)
	topbarobject.InputChanged:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
			DragInput = input
		end
	end)
	UIS.InputChanged:Connect(function(input)
		if input == DragInput and Dragging then
			local Delta = input.Position - DragStart
			object.Position = UDim2.new(StartPosition.X.Scale, StartPosition.X.Offset + Delta.X, StartPosition.Y.Scale, StartPosition.Y.Offset + Delta.Y)
		end
	end)
end

--[
--CreateWindow
--]

function library:CreateWindow(config, parent)
	local WindowInit = {}
	local Folder = game:GetObjects("rbxassetid://7141683860")[1]
	local Screen = Folder.Bracket:Clone()
	
	if exploit_type == "Synapse X" then
		syn.protect_gui(Screen)
	elseif exploit_type == "Script-Ware" then
		gethui(Screen)
	else
		game:GetService("Players").LocalPlayer:Kick("BreakSkill Hub | Your executor is not supported!")
	end
	
	local Main = Screen.Main
	local Holder = Main.Holder
	local Topbar = Main.Topbar
	local TContainer = Holder.TContainer
	local TBContainer = Holder.TBContainer.Holder
	
	Screen.Name = HS:GenerateGUID(false)
	Screen.Parent = parent
	Topbar.WindowName.Text = config.WindowName
	
	MakeDraggable(Topbar, Main)
	
	local function CloseAll()
		for _, Tab in pairs(TContainer:GetChildren()) do
			if Tab:IsA("ScrollingFrame") then
				Tab.Visible = false
			end
		end
	end
	local function ResetAll()
		for _, TabButton in pairs(TBContainer:GetChildren()) do
			if TabButton:IsA("TextButton") then
				TabButton.BackgroundTransparency = 1
			end
		end
		for _, TabButton in pairs(TBContainer:GetChildren()) do
			if TabButton:IsA("TextButton") then
				TabButton.Size = UDim2.new(0, 480 / library.TabCount, 1, 0)
			end
		end
	end
	local function KeepFirst()
		for _, Tab in pairs(TContainer:GetChildren()) do
			if Tab:IsA("ScrollingFrame") then
				if Tab.Name == library.FirstTab .. " T" then
					Tab.Visible = true
				else
					Tab.Visible = false
				end
			end
		end
		for _, TabButton in pairs(TBContainer:GetChildren()) do
			if TabButton:IsA("TextButton") then
				if TabButton.Name == library.FirstTab .. " TB" then
					TabButton.BackgroundTransparency = 0
				else
					TabButton.BackgroundTransparency = 1
				end
			end
		end
	end
	local function Toggle(state)
		if state then
			Main.Visible = true
		elseif not state then
			for _, Pallete in pairs(Screen:GetChildren()) do
				if Pallete:IsA("Frame") and Pallete.Name ~= "Main" then
					Pallete.Visible = false
				end
			end
			Screen.ToolTip.Visible = false
			Main.Visible = false
		end
		library.Toggle = state
	end
	local function ChangeColor(color)
		config.Color = color
		
		for i, v in pairs(library.ColorTable) do
			if v.BackgroundColor3 ~= Color3.fromRGB(50, 50, 50) then
				v.BackgroundColor3 = color
			end
		end
	end
	function WindowInit:Toggle(state)
		Toggle(state)
	end
	function WindowInit:ChangeColor(color)
		ChangeColor(color)
	end
	function WindowInit:SetBackground(ImageId)
		Holder.Image = "rbxassetid://".. ImageId
	end
	function WindowInit:SetBackgroundColor(color)
		Holder.ImageColor3 = color
	end
	function WindowInit:SetBackgroundTransparency(transparency)
		Holder.ImageTransparency = transparency
	end
	function WindowInit:SetTileOffset(offset)
		Holder.TileSize = UDim2.new(0, offset, 0, offset)
	end
	function WindowInit:SetTileScale(scale)
		Holder.TileSize = UDim2.new(scale, 0, scale, 0)
	end
	RS.RenderStepped:Connect(function()
		if library.Toggle then
			Screen.ToolTip.Position = UDim2.new(0, UIS:GetMouseLocation().X + 10, 0, UIS:GetMouseLocation().Y - 5)
		end
	end)
	
	--[
	--CreateTab
	--]
	
	function WindowInit:CreateTab(name)
		local TabInit = {}
		
		local Tab = Folder.Tab:Clone()
		local TabButton = Folder.TabButton:Clone()
		
		Tab.Name = name .. " T"
		Tab.Parent = TContainer
		
		TabButton.Name = name .. " TB"
		TabButton.Parent = TBContainer
		TabButton.Title.Text = name
		TabButton.BackgroundColor3 = config.Color
		
		table.insert(library.ColorTable, TabButton)
		library.TabCount = library.TabCount + 1
		
		if library.TabCount == 1 then
			library.FirstTab = name
		end
		CloseAll()
		ResetAll()
		KeepFirst()
		
		local function GetSide(longest)
			if longest then
				if Tab.LeftSide.ListLayout.AbsoluteContentSize.Y > Tab.RightSide.ListLayout.AbsoluteContentSize.Y then
					return Tab.LeftSide
				else
					return Tab.RightSide
				end
			else
				if Tab.LeftSide.ListLayout.AbsoluteContentSize.Y > Tab.RightSide.ListLayout.AbsoluteContentSize.Y then
					return Tab.RightSide
				else
					return Tab.LeftSide
				end
			end
		end
		TabButton.MouseButton1Click:Connect(function()
			CloseAll()
			ResetAll()
			Tab.Visible = true
			TabButton.BackgroundTransparency = 0
		end)
		Tab.LeftSide.ListLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
			if GetSide(true).Name == Tab.LeftSide.Name then
				Tab.CanvasSize = UDim2.new(0, 0, 0, Tab.LeftSide.ListLayout.AbsoluteContentSize.Y + 10)
			else
				Tab.CanvasSize = UDim2.new(0, 0, 0, Tab.RightSide.ListLayout.AbsoluteContentSize.Y + 10)
			end
		end)
		Tab.RightSide.ListLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
			if GetSide(true).Name == Tab.LeftSide.Name then
				Tab.CanvasSize = UDim2.new(0, 0, 0, Tab.LeftSide.ListLayout.AbsoluteContentSize.Y + 10)
			else
				Tab.CanvasSize = UDim2.new(0, 0, 0, Tab.RightSide.ListLayout.AbsoluteContentSize.Y + 10)
			end
		end)
		
		--[
		--CreateSection
		--]
		
		function TabInit:CreateSection(name)
			local SectionInit = {}
			
			local Section = Folder.Section:Clone()
			
			Section.Name = name .. " S"
			Section.Parent = GetSide(false)
			
			Section.Title.Text = name
			Section.Title.Size = UDim2.new(0, Section.Title.TextBounds.X + 10, 0, 2)
			
			Section.Container.ListLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
				Section.Size = UDim2.new(1, 0, 0, Section.Container.ListLayout.AbsoluteContentSize.Y + 15)
			end)
			
			--[
			--AddLabel
			--]
			
			function SectionInit:AddLabel(name)
				local Label = Folder.Label:Clone()
				
				Label.Name = name .. " L"
				Label.Parent = Section.Container
				Label.Text = name
				Label.Size = UDim2.new(1, -10, 0, Label.TextBounds.Y)
			end
			
			--[
			--AddButton
			--]
			
			function SectionInit:AddButton(name, callback)
				local ButtonInit = {}
				
				local Button = Folder.Button:Clone()
				
				Button.Name = name .. " B"
				Button.Parent = Section.Container
				Button.Title.Text = name
				Button.Size = UDim2.new(1, -10, 0, Button.Title.TextBounds.Y + 5)
				
				table.insert(library.ColorTable, Button)
				
				Button.MouseButton1Down:Connect(function()
					Button.BackgroundColor3 = config.Color
				end)
				Button.MouseButton1Up:Connect(function()
					Button.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
				end)
				Button.MouseLeave:Connect(function()
					Button.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
				end)
				Button.MouseButton1Click:Connect(function()
					callback()
				end)
				
				--[
				--Button AddToolTip
				--]
				
				function ButtonInit:AddToolTip(name)
					if tostring(name):gsub(" ", "") ~= "" then
						Button.MouseEnter:Connect(function()
							Screen.ToolTip.Text = name
							Screen.ToolTip.Size = UDim2.new(0, Screen.ToolTip.TextBounds.X + 5, 0, Screen.ToolTip.TextBounds.Y + 5)
							Screen.ToolTip.Visible = true
						end)
						Button.MouseLeave:Connect(function()
							Screen.ToolTip.Visible = false
						end)
					end
				end
				return ButtonInit
			end
			
			--[
			--AddToggle
			--]
			
			function SectionInit:AddToggle(name, default, callback)
				local ToggleInit = {}
				local DefaultLocal = default or false
				
				local Toggle = Folder.Toggle:Clone()
				
				Toggle.Name = name .. " T"
				Toggle.Parent = Section.Container
				Toggle.Title.Text = name
				Toggle.Size = UDim2.new(1, -10, 0, Toggle.Title.TextBounds.Y + 5)
				
				table.insert(library.ColorTable, Toggle.Toggle)
				
				local ToggleState = false
				
				local function SetState(state)
					if state then
						Toggle.Toggle.BackgroundColor3 = config.Color
					elseif not state then
						Toggle.Toggle.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
					end
					ToggleState = state
					callback(state)
				end
				Toggle.MouseButton1Click:Connect(function()
					ToggleState = not ToggleState
					SetState(ToggleState)
				end)
				
				--[
				--Toggle AddToolTip
				--]
				
				function ToggleInit:AddToolTip(name)
					if tostring(name):gsub(" ", "") ~= "" then
						Toggle.MouseEnter:Connect(function()
							Screen.ToolTip.Text = name
							Screen.ToolTip.Size = UDim2.new(0, Screen.ToolTip.TextBounds.X + 5, 0, Screen.ToolTip.TextBounds.Y + 5)
							Screen.ToolTip.Visible = true
						end)
						Toggle.MouseLeave:Connect(function()
							Screen.ToolTip.Visible = false
						end)
					end
				end
				
				--[
				--Toggle SetState Debug
				--]
				
				if default == nil then
					function ToggleInit:SetState(state)
						SetState(state)
					end
				else
					SetState(DefaultLocal)
				end
				
				--[
				--Toggle GetState
				--]
				
				function ToggleInit:GetState(state)
					return ToggleState
				end
				
				--[
				--Toggle CreateKeybind
				--]
				
				function ToggleInit:CreateKeybind(bind, callback)
					local KeybindInit = {}
					local Bind = bind or "NONE"
					local WaitingForBind = false
					local Selected = Bind
					
					local Blacklisted = {
						"W",
						"A",
						"S",
						"D",
						"Slash",
						"Tab",
						"Backspace",
						"Escape",
						"Space",
						"Delete",
						"Unknown",
						"Backquote"
					}
					
					Toggle.Keybind.Visible = true
					Toggle.Keybind.Text = "[ " .. Bind .. " ]"
					
					Toggle.Keybind.MouseButton1Click:Connect(function()
						Toggle.Keybind.Text = "[ ... ]"
						WaitingForBind = true
					end)
					Toggle.Keybind:GetPropertyChangedSignal("TextBounds"):Connect(function()
						Toggle.Keybind.Size = UDim2.new(0, Toggle.Keybind.TextBounds.X, 1, 0)
						Toggle.Title.Size = UDim2.new(1, -Toggle.Keybind.Size.X.Offset - 15, 1, 0)
					end)
					UIS.InputBegan:Connect(function(input)
						if WaitingForBind and input.UserInputType == Enum.UserInputType.Keyboard then
							local Key = tostring(input.KeyCode):gsub("Enum.KeyCode.", "")
							
							if not table.find(Blacklisted, Key) then
								Toggle.Keybind.Text = "[ " .. Key .. " ]"
								Selected = Key
							else
								Toggle.Keybind.Text = "[ NONE ]"
								Selected = "NONE"
							end
							WaitingForBind = false
						elseif input.UserInputType == Enum.UserInputType.Keyboard then
							local Key = tostring(input.KeyCode):gsub("Enum.KeyCode.", "")
							
							if Key == Selected then
								ToggleState = not ToggleState
								SetState(ToggleState)
								
								if callback then
									callback(Key)
								end
							end
						end
					end)
					
					--[
					--Toggle Keybind SetBind
					--]
					
					function KeybindInit:SetBind(key)
						Toggle.Keybind.Text = "[ " .. key .. " ]"
						Selected = key
					end
					
					--[
					--Toggle Keybind GetBind
					--]
					
					function KeybindInit:GetBind()
						return Selected
					end
					return KeybindInit
				end
				return ToggleInit
			end
			
			--[
			--AddSlider
			--]
			
			function SectionInit:AddSlider(name, min, max, default, precise, callback)
				local SliderInit = {}
				local DefaultLocal = default or 50
				
				local Slider = Folder.Slider:Clone()
				
				Slider.Name = name .. " S"
				Slider.Parent = Section.Container
				Slider.Title.Text = name
				Slider.Slider.Bar.Size = UDim2.new(min / max, 0, 1, 0)
				Slider.Slider.Bar.BackgroundColor3 = config.Color
				Slider.Value.PlaceholderText = tostring(min / max)
				Slider.Title.Size = UDim2.new(1, 0, 0, Slider.Title.TextBounds.Y + 5)
				Slider.Size = UDim2.new(1, -10, 0, Slider.Title.TextBounds.Y + 15)
				
				table.insert(library.ColorTable, Slider.Slider.Bar)
				
				local GlobalSliderValue = 0
				local Dragging = false
				
				local function Sliding(input)
					local Position = UDim2.new(math.clamp((input.Position.X - Slider.Slider.AbsolutePosition.X) / Slider.Slider.AbsoluteSize.X, 0, 1), 0, 1, 0)
					Slider.Slider.Bar.Size = Position
					local SliderPrecise = ((Position.X.Scale * max) / max) * (max - min) + min
					local SliderNonPrecise = math.floor(((Position.X.Scale * max) / max) * (max - min) + max)
					local SliderValue = precise and SliderNonPrecise or SliderPrecise
					SliderValue = tonumber(string.format("%.2f", SliderValue))
					GlobalSliderValue = SliderValue
					Slider.Value.PlaceholderText = tostring(SliderValue)
					callback(GlobalSliderValue)
				end
				local function SetValue(value)
					GlobalSliderValue = value
					Slider.Slider.Bar.Size = UDim2.new(value / max, 0, 1, 0)
					Slider.Value.PlaceholderText = value
					callback(value)
				end
				Slider.Value.FocusLost:Connect(function()
					if not tonumber(Slider.Value.Text) then
						Slider.Value.Text = GlobalSliderValue
					elseif Slider.Value.Text == "" or tonumber(Slider.Value.Text) <= min then
						Slider.Value.Text = min
					elseif Slider.Value.Text == "" or tonumber(Slider.Value.Text) >= max then
						Slider.Value.Text = max
					end
					GlobalSliderValue = Slider.Value.Text
					Slider.Slider.Bar.Size = UDim2.new(Slider.Value.Text / max, 0, 1, 0)
					Slider.Value.PlaceholderText = Slider.Value.Text
					callback(tonumber(Slider.Value.Text))
					Slider.Value.Text = ""
				end)
				Slider.InputBegan:Connect(function(input)
					if input.UserInputType == Enum.UserInputType.MouseButton1  then
						Sliding(input)
						Dragging = true
					end
				end)
				Slider.InputEnded:Connect(function(input)
					if input.UserInputType == Enum.UserInputType.MouseButton1 then
						Dragging = false
					end
				end)
				UIS.InputBegan:Connect(function(input)
					if input.KeyCode == Enum.KeyCode.LeftControl then
						Slider.Value.ZIndex = 4
					end
				end)
				UIS.InputEnded:Connect(function(input)
					if input.KeyCode == Enum.KeyCode.LeftControl then
						Slider.Value.ZIndex = 3
					end
				end)
				UIS.InputChanged:Connect(function(input)
					if Dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
						Sliding(input)
					end
				end)
				
				--[
				--Slider AddToolTip
				--]
				
				function SliderInit:AddToolTip(name)
					if tostring(name):gsub(" ", "") ~= "" then
						Slider.MouseEnter:Connect(function()
							Screen.ToolTip.Text = name
							Screen.ToolTip.Size = UDim2.new(0, Screen.ToolTip.TextBounds.X + 5, 0, Screen.ToolTip.TextBounds.Y + 5)
							Screen.ToolTip.Visible = true
						end)
						Slider.MouseLeave:Connect(function()
							Screen.ToolTip.Visible = false
						end)
					end
				end
				
				--[
				--Slider SetValue Debug
				--]
				
				if default == nil then
					function SliderInit:SetValue(value)
						GlobalSliderValue = value
						Slider.Slider.Bar.Size = UDim2.new(value / max, 0, 1, 0)
						Slider.Value.PlaceholderText = value
						callback(value)
					end
				else
					SetValue(DefaultLocal)
				end
				
				--[
				--Slider GetValue
				--]
				
				function SliderInit:GetValue(value)
					return GlobalSliderValue
				end
				return SliderInit
			end
			
			--[
			--AddDropdown
			--]
			
			function SectionInit:AddDropdown(name)
				local DropdownInit = {}
				local DropdownToggle = false
				
				local Dropdown = Folder.Dropdown:Clone()
				
				Dropdown.Name = name .. " D"
				Dropdown.Parent = Section.Container
				Dropdown.Title.Text = name
				Dropdown.Title.Size = UDim2.new(1, 0, 0, Dropdown.Title.TextBounds.Y + 5)
				Dropdown.Container.Position = UDim2.new(0, 0, 0, Dropdown.Title.TextBounds.Y + 5)
				Dropdown.Size = UDim2.new(1, -10, 0, Dropdown.Title.TextBounds.Y + 25)
				
				Dropdown.MouseButton1Click:Connect(function()
					DropdownToggle = not DropdownToggle
					
					if DropdownToggle then
						Dropdown.Size = UDim2.new(1, -10, 0, Dropdown.Container.Holder.Container.ListLayout.AbsoluteContentSize.Y + Dropdown.Title.TextBounds.Y + 30)
						Dropdown.Container.Holder.Visible = true
					else
						Dropdown.Size = UDim2.new(1, -10, 0, Dropdown.Title.TextBounds.Y + 25)
						Dropdown.Container.Holder.Visible = false
					end
				end)
				
				--[
				--Dropdown AddToolTip
				--]
				
				function DropdownInit:AddToolTip(name)
					if tostring(name):gsub(" ", "") ~= "" then
						Dropdown.MouseEnter:Connect(function()
							Screen.ToolTip.Text = name
							Screen.ToolTip.Size = UDim2.new(0, Screen.ToolTip.TextBounds.X + 5, 0, Screen.ToolTip.TextBounds.Y + 5)
							Screen.ToolTip.Visible = true
						end)
						Dropdown.MouseLeave:Connect(function()
							Screen.ToolTip.Visible = false
						end)
					end
				end
				
				--[
				--Dropdown AddOption
				--]
				
				function DropdownInit:AddOption(name, callback)
					local OptionInit = {}
					
					local Option = Folder.Option:Clone()
					
					Option.Name = name .. " O"
					Option.Parent = Dropdown.Container.Holder.Container
					Option.Title.Text = name
					Option.BackgroundColor3 = config.Color
					Option.Size = UDim2.new(1, 0, 0, Option.Title.TextBounds.Y + 5)
					Dropdown.Container.Holder.Size = UDim2.new(1, -5, 0, Dropdown.Container.Holder.Container.ListLayout.AbsoluteContentSize.Y)
					
					table.insert(library.ColorTable, Option)
					
					Option.MouseButton1Down:Connect(function()
						Option.BackgroundTransparency = 0
					end)
					Option.MouseButton1Up:Connect(function()
						Option.BackgroundTransparency = 1
					end)
					Option.MouseLeave:Connect(function()
						Option.BackgroundTransparency = 1
					end)
					Option.MouseButton1Click:Connect(function()
						Dropdown.Container.Value.Text = name
						callback(name)
					end)
					
					--[
					--Dropdown Option SetOption
					--]
					
					function OptionInit:SetOption()
						Dropdown.Container.Value.Text = name
						callback(name)
					end
					
					--[
					--Dropdown Option Remove
					--]
					
					function OptionInit:Remove()
						Option:Destroy()
						Dropdown.Container.Holder.Size = UDim2.new(1, -5, 0, Dropdown.Container.Holder.Container.ListLayout.AbsoluteContentSize.Y)
						Dropdown.Size = UDim2.new(1, -10, 0, Dropdown.Container.Holder.Container.ListLayout.AbsoluteContentSize.Y + Dropdown.Title.TextBounds.Y + 30)
					end
					return OptionInit
				end
				
				--[
				--Dropdown ClearOptions
				--]
				
				function DropdownInit:ClearOptions()
					for _, Option in pairs(Dropdown.Container.Holder.Container:GetChildren()) do
						if Option:IsA("TextButton") then
							Option:Destroy()
						end
					end
					Dropdown.Container.Holder.Size = UDim2.new(1, -5, 0, Dropdown.Container.Holder.Container.ListLayout.AbsoluteContentSize.Y)
					Dropdown.Size = UDim2.new(1, -10, 0, Dropdown.Container.Holder.Container.ListLayout.AbsoluteContentSize.Y + Dropdown.Title.TextBounds.Y + 30)
				end
				
				--[
				--Dropdown GetOption
				--]
				
				function DropdownInit:GetOption()
					return Dropdown.Container.Value.Text
				end
				return DropdownInit
			end
			
			--[
			--ColorPicker
			--]
			
			function SectionInit:AddColorPicker(name, callback)
				local ColorPickerInit = {}
				local ColorRender = nil
				local HUERender = nil
				local ColorPickerToggle = false
				local ColorTable = {
					HUE = 1,
					Saturation = 0,
					Value = 0
				}
				
				local ColorPicker = Folder.Colorpicker:Clone()
				local Pallete = Folder.Pallete:Clone()
				
				ColorPicker.Name = name .. " CP"
				ColorPicker.Parent = Section.Container
				ColorPicker.Title.Text = name
				ColorPicker.Size = UDim2.new(1, -10, 0, ColorPicker.Title.TextBounds.Y + 5)
				
				Pallete.Name = name .. " P"
				Pallete.Parent = Screen
				Pallete.Position = UDim2.new(0, ColorPicker.Color.AbsolutePosition.X - 129, 0, ColorPicker.Color.AbsolutePosition.Y + 52)
				
				local function UpdateColor()
					ColorPicker.Color.BackgroundColor3 = Color3.fromHSV(ColorTable.HUE, ColorTable.Saturation, ColorTable.Value)
					Pallete.GradientPallete.BackgroundColor3 = Color3.fromHSV(ColorTable.HUE, 1, 1)
					Pallete.Input.InputBox.PlaceholderText = "RGB: " .. math.round(ColorPicker.Color.BackgroundColor3.R * 255) .. "," .. math.round(ColorPicker.Color.BackgroundColor3.G * 255) .. "," .. math.round(ColorPicker.Color.BackgroundColor3.B * 255)
					callback(ColorPicker.Color.BackgroundColor3)
				end
				ColorPicker.MouseButton1Click:Connect(function()
					ColorPickerToggle = not ColorPickerToggle
					
					if ColorPickerToggle then
						Pallete.Visible = true
						Pallete.Position = UDim2.new(0, ColorPicker.Color.AbsolutePosition.X - 129, 0, ColorPicker.Color.AbsolutePosition.Y + 52)
					else
						Pallete.Visible = false
					end
				end)
				Pallete.GradientPallete.InputBegan:Connect(function(input)
					if input.UserInputType == Enum.UserInputType.MouseButton1 then
						if ColorRender then
							ColorRender:Disconnect()
						end
						ColorRender = RS.RenderStepped:Connect(function()
							local Mouse = UIS:GetMouseLocation()
							local ColorX = math.clamp(Mouse.X - Pallete.GradientPallete.AbsolutePosition.X, 0, Pallete.GradientPallete.AbsoluteSize.X) / Pallete.GradientPallete.AbsoluteSize.X
							local ColorY = math.clamp((Mouse.Y - 37) - Pallete.GradientPallete.AbsolutePosition.Y, 0, Pallete.GradientPallete.AbsoluteSize.Y) / Pallete.GradientPallete.AbsoluteSize.Y
							Pallete.GradientPallete.Dot.Position = UDim2.new(ColorX, 0, ColorY, 0)
							ColorTable.Saturation = ColorX
							ColorTable.Value = 1 - ColorY
							UpdateColor()
						end)
					end
				end)
				Pallete.GradientPallete.InputEnded:Connect(function(input)
					if input.UserInputType == Enum.UserInputType.MouseButton1 then
						if ColorRender then
							ColorRender:Disconnect()
						end
					end
				end)
				Pallete.ColorSlider.InputBegan:Connect(function(input)
					if input.UserInputType == Enum.UserInputType.MouseButton1 then
						if HUERender then
							HUERender:Disconnect()
						end
						HUERender = RS.RenderStepped:Connect(function()
							local Mouse = UIS:GetMouseLocation()
							local HUEX = math.clamp(Mouse.X - Pallete.ColorSlider.AbsolutePosition.X, 0, Pallete.ColorSlider.AbsoluteSize.X) / Pallete.ColorSlider.AbsoluteSize.X
							ColorTable.HUE = 1 - HUEX
							UpdateColor()
						end)
					end
				end)
				Pallete.ColorSlider.InputEnded:Connect(function(input)
					if input.UserInputType == Enum.UserInputType.MouseButton1 then
						if HUERender then
							HUERender:Disconnect()
						end
					end
				end)
				
				--[
				--ColorPicker UpdateColor
				--]
				
				function ColorPickerInit:UpdateColor(color)
					local HUE, Saturation, Value = color:ToHSV()
					ColorPicker.Color.BackgroundColor3 = Color3.fromHSV(HUE, Saturation, Value)
					Pallete.GradientPallete.BackgroundColor3 = Color3.fromHSV(HUE, 1, 1)
					Pallete.Input.InputBox.PlaceholderText = "RGB: " .. math.round(ColorPicker.Color.BackgroundColor3.R * 255) .. "," .. math.round(ColorPicker.Color.BackgroundColor3.G * 255) .. "," .. math.round(ColorPicker.Color.BackgroundColor3.B * 255)
					ColorTable = {
						HUE = HUE,
						Saturation = Saturation,
						Value = Value
					}
					callback(color)
				end
				Pallete.Input.InputBox.FocusLost:Connect(function(enter)
					if enter then
						local ColorString = string.split(string.gsub(Pallete.Input.InputBox.Text, " ", ""), ",")
						ColorPickerInit:UpdateColor(Color3.fromRGB(ColorString[1], ColorString[2], ColorString[3]))
						Pallete.Input.InputBox.Text = ""
					end
				end)
				
				--[
				--ColorPicker AddToolTip
				--]
				
				function ColorPickerInit:AddToolTip(name)
					if tostring(name):gsub(" ", "") ~= "" then
						ColorPicker.MouseEnter:Connect(function()
							Screen.ToolTip.Text = name
							Screen.ToolTip.Size = UDim2.new(0, Screen.ToolTip.TextBounds.X + 5, 0, Screen.ToolTip.TextBounds.Y + 5)
							Screen.ToolTip.Visible = true
						end)
						ColorPicker.MouseLeave:Connect(function()
							Screen.ToolTip.Visible = false
						end)
					end
				end
				return ColorPickerInit
			end
			return SectionInit
		end
		return TabInit
	end
	return WindowInit
end

return library
